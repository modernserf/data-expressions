<!doctype html><html ><head ><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1"><title >operations.js | DatEx</title><link rel="stylesheet" type="text/css" href="doc.css" /></head><body ><aside class="comment"><h1 id="operations">Operations</h1>
<p> DatEx patterns are generators that yield <code>{ match, replace }</code> objects. These functions provide a more usable interface to getting results from patterns.</p>
<h2 id="-matchall"><code>.matchAll</code></h2>
<p> Returns a match object, with the following properties:</p>
<ul>
<li><p><code>matched</code>: <code>true</code> if the match succeeded, <code>false</code> if it failed</p>
</li>
<li><p><code>result</code>: the first match result, or <code>undefined</code> if the match failed</p>
</li>
</ul>
<p> It also works as an iterator that yields <em>all</em> match results.</p>
</aside><details class="content"><summary ><code ><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">matchAll</span> <span class="token punctuation">(</span>pattern<span class="token punctuation">,</span> focus<span class="token punctuation">)</span> <span class="token punctuation">{</span></code></summary><code >  <span class="token keyword">const</span> gen <span class="token operator">=</span> <span class="token function">pattern</span><span class="token punctuation">(</span>focus<span class="token punctuation">)</span></code><code >  <span class="token keyword">const</span> <span class="token punctuation">{</span> value<span class="token punctuation">,</span> done <span class="token punctuation">}</span> <span class="token operator">=</span> gen<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code><code >  <span class="token keyword">const</span> matched <span class="token operator">=</span> <span class="token operator">!</span>done</code><code >  <span class="token keyword">const</span> firstMatch <span class="token operator">=</span> matched <span class="token operator">?</span> value<span class="token punctuation">.</span>match <span class="token punctuation">:</span> undefined</code><code >  <span class="token keyword">return</span> <span class="token punctuation">{</span></code><code >    matched<span class="token punctuation">,</span></code><code >    result<span class="token punctuation">:</span> firstMatch<span class="token punctuation">,</span></code><code >    <span class="token operator">*</span> <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><code >      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>matched<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token punctuation">}</span></code><code >      <span class="token keyword">yield</span> firstMatch</code><code >      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token punctuation">{</span> match <span class="token punctuation">}</span> <span class="token keyword">of</span> gen<span class="token punctuation">)</span> <span class="token punctuation">{</span></code><code >        <span class="token keyword">yield</span> match</code><code >      <span class="token punctuation">}</span></code><code >    <span class="token punctuation">}</span></code><code >  <span class="token punctuation">}</span></code><code ><span class="token punctuation">}</span></code></details><section class="test" id="test_export function test_op_matchAll,op_matchAll"><code setup><span class="token keyword">const</span> m <span class="token operator">=</span> dx<span class="token template-string"><span class="token string">`*`</span></span><span class="token punctuation">.</span><span class="token function">matchAll</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token string">'bar'</span><span class="token punctuation">,</span> <span class="token string">'baz'</span><span class="token punctuation">]</span><span class="token punctuation">)</span></code><code class="expect">m<span class="token punctuation">.</span>matched</code><code class="to-equal"><span class="token boolean">true</span></code><code class="expect">m<span class="token punctuation">.</span>result</code><code class="to-equal"><span class="token string">'foo'</span></code><code class="expect"><span class="token punctuation">[</span><span class="token operator">...</span>m<span class="token punctuation">]</span></code><code class="to-equal"><span class="token punctuation">[</span><span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token string">'bar'</span><span class="token punctuation">,</span> <span class="token string">'baz'</span><span class="token punctuation">]</span></code></section><aside class="comment"><h2 id="-test"><code>.test</code></h2>
<p> Returns <code>true</code> if the match succeeded, <code>false</code> if it failed</p>
</aside><details class="content"><summary ><code ><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">test</span> <span class="token punctuation">(</span>pattern<span class="token punctuation">,</span> focus<span class="token punctuation">)</span> <span class="token punctuation">{</span></code></summary><code >  <span class="token keyword">return</span> <span class="token function">matchAll</span><span class="token punctuation">(</span>pattern<span class="token punctuation">,</span> focus<span class="token punctuation">)</span><span class="token punctuation">.</span>matched</code><code ><span class="token punctuation">}</span></code></details><section class="test" id="test_export function test_op_test,op_test"><code class="expect">dx<span class="token template-string"><span class="token string">`.foo.bar`</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">{</span> foo<span class="token punctuation">:</span> <span class="token punctuation">{</span> bar<span class="token punctuation">:</span> <span class="token number">3</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span></code><code class="to-equal"><span class="token boolean">true</span></code></section><aside class="comment"><h2 id="-match"><code>.match</code></h2>
<p> Returns the first match result, or <code>undefined</code> if the match failed.</p>
</aside><details class="content"><summary ><code ><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">match</span> <span class="token punctuation">(</span>pattern<span class="token punctuation">,</span> focus<span class="token punctuation">)</span> <span class="token punctuation">{</span></code></summary><code >  <span class="token keyword">return</span> <span class="token function">matchAll</span><span class="token punctuation">(</span>pattern<span class="token punctuation">,</span> focus<span class="token punctuation">)</span><span class="token punctuation">.</span>result</code><code ><span class="token punctuation">}</span></code></details><section class="test" id="test_export function test_op_match,op_match"><code class="expect">dx<span class="token template-string"><span class="token string">`.foo.bar`</span></span><span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token punctuation">{</span> foo<span class="token punctuation">:</span> <span class="token punctuation">{</span> bar<span class="token punctuation">:</span> <span class="token number">3</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span></code><code class="to-equal"><span class="token number">3</span></code></section><aside class="comment"><h2 id="-replace"><code>.replace</code></h2>
<p> Returns the focus with its matched value replaced if the match succeded; otherwise returns the original focus.</p>
</aside><details class="content"><summary ><code ><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">replace</span> <span class="token punctuation">(</span>pattern<span class="token punctuation">,</span> focus<span class="token punctuation">,</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span></code></summary><code >  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token punctuation">{</span> replace <span class="token punctuation">}</span> <span class="token keyword">of</span> <span class="token function">pattern</span><span class="token punctuation">(</span>focus<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><code >    <span class="token keyword">return</span> <span class="token function">replace</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span></code><code >  <span class="token punctuation">}</span></code><code >  <span class="token keyword">return</span> focus</code><code ><span class="token punctuation">}</span></code></details><section class="test" id="test_export function test_op_replace,op_replace"><code class="expect">dx<span class="token template-string"><span class="token string">`.foo.bar`</span></span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token punctuation">{</span> foo<span class="token punctuation">:</span> <span class="token punctuation">{</span> bar<span class="token punctuation">:</span> <span class="token number">3</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span></code><code class="to-equal"><span class="token punctuation">{</span> foo<span class="token punctuation">:</span> <span class="token punctuation">{</span> bar<span class="token punctuation">:</span> <span class="token number">5</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span></code></section><aside class="comment"><h2 id="-updateall"><code>.updateAll</code></h2>
<p> TODO.</p>
</aside><details class="content"><summary ><code ><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token operator">*</span> <span class="token function">updateAll</span> <span class="token punctuation">(</span>pattern<span class="token punctuation">,</span> focus<span class="token punctuation">,</span> fn<span class="token punctuation">)</span> <span class="token punctuation">{</span></code></summary><code >  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token punctuation">{</span> match<span class="token punctuation">,</span> replace <span class="token punctuation">}</span> <span class="token keyword">of</span> <span class="token function">pattern</span><span class="token punctuation">(</span>focus<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><code >    <span class="token keyword">yield</span> <span class="token function">replace</span><span class="token punctuation">(</span><span class="token function">fn</span><span class="token punctuation">(</span>match<span class="token punctuation">)</span><span class="token punctuation">)</span></code><code >  <span class="token punctuation">}</span></code><code ><span class="token punctuation">}</span></code></details><aside class="comment"><h2 id="decoratepattern"><code>decoratePattern</code></h2>
<p> Decorates a pattern with these functions to use in an &quot;object-oriented&quot; style. Used by patterns generated by the <code>dx</code> template string.</p>
</aside><details class="content"><summary ><code ><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">decoratePattern</span> <span class="token punctuation">(</span>pattern<span class="token punctuation">)</span> <span class="token punctuation">{</span></code></summary><code >  pattern<span class="token punctuation">.</span><span class="token function-variable function">test</span> <span class="token operator">=</span> <span class="token punctuation">(</span>focus<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">test</span><span class="token punctuation">(</span>pattern<span class="token punctuation">,</span> focus<span class="token punctuation">)</span></code><code >  pattern<span class="token punctuation">.</span><span class="token function-variable function">match</span> <span class="token operator">=</span> <span class="token punctuation">(</span>focus<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">match</span><span class="token punctuation">(</span>pattern<span class="token punctuation">,</span> focus<span class="token punctuation">)</span></code><code >  pattern<span class="token punctuation">.</span><span class="token function-variable function">matchAll</span> <span class="token operator">=</span> <span class="token punctuation">(</span>focus<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">matchAll</span><span class="token punctuation">(</span>pattern<span class="token punctuation">,</span> focus<span class="token punctuation">)</span></code><code >  pattern<span class="token punctuation">.</span><span class="token function-variable function">replace</span> <span class="token operator">=</span> <span class="token punctuation">(</span>focus<span class="token punctuation">,</span> value<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">replace</span><span class="token punctuation">(</span>pattern<span class="token punctuation">,</span> focus<span class="token punctuation">,</span> value<span class="token punctuation">)</span></code><code >  pattern<span class="token punctuation">.</span><span class="token function-variable function">updateAll</span> <span class="token operator">=</span> <span class="token punctuation">(</span>focus<span class="token punctuation">,</span> value<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">updateAll</span><span class="token punctuation">(</span>pattern<span class="token punctuation">,</span> focus<span class="token punctuation">,</span> value<span class="token punctuation">)</span></code><code >  <span class="token keyword">return</span> pattern</code><code ><span class="token punctuation">}</span></code></details></body></html>